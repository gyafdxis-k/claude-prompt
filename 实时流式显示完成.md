# âœ… å®æ—¶æµå¼æ˜¾ç¤ºåŠŸèƒ½å®Œæˆ

## ğŸ‰ æ–°åŠŸèƒ½

### 1. å®æ—¶æµå¼æ˜¾ç¤ºçª—å£

**æ‰§è¡Œå·¥ä½œæµæ—¶ï¼Œä¼šåœ¨å³ä¸‹è§’å¼¹å‡ºä¸€ä¸ªå®æ—¶æ˜¾ç¤ºçª—å£ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ§  Claude æ€è€ƒä¸­...        â— â— â—      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“¤ Promptâ”‚ ğŸ“¥ å“åº”                     â”‚
â”‚          â”‚                             â”‚
â”‚ (å·¦ä¾§)   â”‚ (å³ä¾§å®æ—¶æ˜¾ç¤º)              â”‚
â”‚ å®Œæ•´çš„   â”‚ Markdown æ¸²æŸ“çš„å“åº”         â”‚
â”‚ prompt   â”‚ è¾¹ç”Ÿæˆè¾¹æ˜¾ç¤º â–Š              â”‚
â”‚ å†…å®¹     â”‚                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. å®æ—¶æµå¼ä¼ è¾“

- **Server-Sent Events (SSE)**: åç«¯ä½¿ç”¨ SSE å®æ—¶æ¨é€æ•°æ®
- **å‰ç«¯å®æ—¶æ¸²æŸ“**: æ¯æ”¶åˆ°ä¸€ä¸ªæ–‡æœ¬å—å°±ç«‹å³æ˜¾ç¤º
- **Markdown æ¸²æŸ“**: å“åº”å†…å®¹ä½¿ç”¨ Markdown æ ¼å¼æ¸²æŸ“

### 3. æ˜¾ç¤ºå†…å®¹

#### å·¦ä¾§ (1/3 å®½åº¦)
- ğŸ“¤ **å‘é€çš„ Prompt**
- å®Œæ•´çš„ prompt å†…å®¹ï¼ˆåŒ…å«æ‰€æœ‰å˜é‡æ›¿æ¢åçš„ç»“æœï¼‰
- ä»£ç æ ¼å¼æ˜¾ç¤º

#### å³ä¾§ (2/3 å®½åº¦)
- ğŸ“¥ **Claude çš„å“åº”**
- å®æ—¶æµå¼æ˜¾ç¤º
- Markdown æ ¼å¼æ¸²æŸ“
- å…‰æ ‡åŠ¨ç”» â–Š æ˜¾ç¤ºæ­£åœ¨ç”Ÿæˆ

## ğŸ”§ æŠ€æœ¯å®ç°

### åç«¯ API (`app/api/workflow/execute/route.ts`)

```typescript
// ä½¿ç”¨ ReadableStream è¿›è¡Œæµå¼ä¼ è¾“
const stream = new ReadableStream({
  async start(controller) {
    // 1. å‘é€ prompt
    controller.enqueue(encoder.encode(`data: ${JSON.stringify({ 
      type: 'prompt', 
      data: prompt 
    })}\n\n`));

    // 2. æµå¼å‘é€ Claude å“åº”
    for await (const chunk of claudeService.streamMessage(prompt)) {
      controller.enqueue(encoder.encode(`data: ${JSON.stringify({ 
        type: 'chunk', 
        data: chunk 
      })}\n\n`));
    }

    // 3. å‘é€å®Œæˆä¿¡å·
    controller.enqueue(encoder.encode(`data: ${JSON.stringify({ 
      type: 'done', 
      data: output 
    })}\n\n`));
  }
});

return new Response(stream, {
  headers: {
    'Content-Type': 'text/event-stream',
    'Cache-Control': 'no-cache',
    'Connection': 'keep-alive',
  },
});
```

### å‰ç«¯ (`app/page.tsx`)

```typescript
// ä½¿ç”¨ fetch + ReadableStream æ¥æ”¶æµå¼æ•°æ®
const reader = response.body?.getReader();
const decoder = new TextDecoder();

while (true) {
  const { done, value } = await reader.read();
  
  if (done) break;

  // è§£æ SSE æ ¼å¼æ•°æ®
  buffer += decoder.decode(value, { stream: true });
  const lines = buffer.split('\n\n');
  
  for (const line of lines) {
    if (line.startsWith('data: ')) {
      const data = JSON.parse(line.slice(6));
      
      if (data.type === 'prompt') {
        setStreamingPrompt(data.data);
      } else if (data.type === 'chunk') {
        setStreamingResponse(prev => prev + data.data);
      } else if (data.type === 'done') {
        // ä¿å­˜åˆ°ä¸Šä¸‹æ–‡
        setContext({ ...context, outputs: [...outputs, data.data] });
      }
    }
  }
}
```

### æ˜¾ç¤ºç»„ä»¶ (`components/StreamingDisplay.tsx`)

```typescript
<div className="fixed bottom-0 right-0 w-2/3 h-2/3">
  {/* å·¦ä¾§: Prompt */}
  <div className="w-1/3">
    <pre>{prompt}</pre>
  </div>
  
  {/* å³ä¾§: å®æ—¶å“åº” */}
  <div className="w-2/3">
    <ReactMarkdown>{response}</ReactMarkdown>
    {isStreaming && <div>â–Š</div>}
  </div>
</div>
```

## ğŸ“‹ Prompt æ¨¡æ¿ç³»ç»Ÿ

### å·²åˆ›å»º Prompt æ‰«æå™¨ (`lib/prompts/prompt-scanner.ts`)

**åŠŸèƒ½ï¼š**
- âœ… æ‰«ææœ¬åœ° `/Users/gaodong/Desktop/claude_prompt/system-prompts-and-models-of-ai-tools` ç›®å½•
- âœ… è‡ªåŠ¨è¯†åˆ«æ‰€æœ‰ `.txt` å’Œ `.md` æ–‡ä»¶
- âœ… æå– prompt æ¨¡æ¿ä¸­çš„å‚æ•°
- âœ… æ”¯æŒå¤šç§å‚æ•°æ ¼å¼ï¼š`${param}`, `{{param}}`, `<param>`, `[param]`
- âœ… è‡ªåŠ¨ç”Ÿæˆå‚æ•°æè¿°å’Œç±»å‹

### Prompt æ¨¡æ¿æ¥å£

```typescript
interface PromptTemplate {
  id: string;              // å”¯ä¸€ID
  name: string;            // æ˜¾ç¤ºåç§°
  description: string;     // æè¿°
  category: string;        // åˆ†ç±»ï¼ˆClaude Code, Cursor, etc.ï¼‰
  source: string;          // æºæ–‡ä»¶è·¯å¾„
  content: string;         // å®Œæ•´å†…å®¹
  parameters: PromptParameter[];  // å‚æ•°åˆ—è¡¨
}

interface PromptParameter {
  name: string;            // å‚æ•°å
  description: string;     // æè¿°
  required: boolean;       // æ˜¯å¦å¿…éœ€
  defaultValue?: string;   // é»˜è®¤å€¼
  type: 'string' | 'file' | 'files' | 'code' | 'number';
}
```

### æ‰«æçš„ Prompt æ¨¡æ¿æ¥æº

ä»ä»¥ä¸‹ç›®å½•è‡ªåŠ¨æ‰«æï¼š
- âœ… Claude Code
- âœ… Cursor Prompts
- âœ… Augment Code
- âœ… CodeBuddy Prompts
- âœ… Open Source prompts (Cline, RooCode, etc.)
- âœ… VSCode Agent
- âœ… è¿˜æœ‰ 20+ ä¸ªå…¶ä»–åˆ†ç±»...

### API ç«¯ç‚¹

**GET `/api/prompts/scan`**
```json
{
  "prompts": [
    {
      "id": "claude-code-claude-code-system-prompt",
      "name": "Claude Code ç³»ç»Ÿæç¤º",
      "category": "Claude Code",
      "parameters": [
        { "name": "cwd", "type": "string", "required": true },
        { "name": "task", "type": "string", "required": true }
      ]
    }
  ],
  "count": 50
}
```

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### 1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
cd /Users/gaodong/Desktop/claude_prompt/claude-dev-assistant
npm run dev
```

### 2. æ‰“å¼€æµè§ˆå™¨

è®¿é—®: **http://localhost:3000**

### 3. æ‰§è¡Œå·¥ä½œæµ

1. é€‰æ‹©å·¦ä¾§çš„å·¥ä½œæµï¼ˆå¦‚ï¼šğŸš€ åŠŸèƒ½å¼€å‘å®Œæ•´æµç¨‹ï¼‰
2. å¡«å†™éœ€æ±‚å’Œç›¸å…³æ–‡ä»¶
3. ç‚¹å‡» "æ‰§è¡Œæ­¤æ­¥éª¤"
4. **ç«‹å³çœ‹åˆ°å³ä¸‹è§’å¼¹å‡ºå®æ—¶æ˜¾ç¤ºçª—å£**

### 4. è§‚å¯Ÿå®æ—¶æµå¼æ˜¾ç¤º

**ä½ ä¼šçœ‹åˆ°ï¼š**
- âœ… å·¦ä¾§æ˜¾ç¤ºå®Œæ•´çš„ Promptï¼ˆåŒ…å«æ‰€æœ‰ä¸Šä¸‹æ–‡ï¼‰
- âœ… å³ä¾§å®æ—¶æ˜¾ç¤º Claude çš„å“åº”ï¼ˆè¾¹ç”Ÿæˆè¾¹æ˜¾ç¤ºï¼‰
- âœ… Markdown æ ¼å¼æ¸²æŸ“ï¼ˆä»£ç å—ã€åˆ—è¡¨ã€æ ‡é¢˜ç­‰ï¼‰
- âœ… å…‰æ ‡åŠ¨ç”»è¡¨ç¤ºæ­£åœ¨ç”Ÿæˆ
- âœ… å®Œæˆåçª—å£è‡ªåŠ¨å…³é—­æˆ–ä¿ç•™ï¼ˆå¯é…ç½®ï¼‰

## ğŸ“Š å¯¹æ¯”ï¼šä¹‹å‰ vs ç°åœ¨

### âŒ ä¹‹å‰
- ç­‰å¾… 10-30 ç§’ï¼Œä»€ä¹ˆéƒ½çœ‹ä¸åˆ°
- åªæœ‰ä¸€ä¸ª "æ‰§è¡Œä¸­..." æŒ‰é’®
- å®Œæˆåæ‰èƒ½çœ‹åˆ°ç»“æœ
- ä¸çŸ¥é“ prompt çš„å†…å®¹

### âœ… ç°åœ¨
- **0 ç§’å»¶è¿Ÿ**ï¼Œç«‹å³çœ‹åˆ° prompt
- **å®æ—¶çœ‹åˆ°** Claude çš„æ€è€ƒè¿‡ç¨‹
- **è¾¹ç”Ÿæˆè¾¹æ˜¾ç¤º**ï¼Œåƒæ‰“å­—ä¸€æ ·
- **å®Œæ•´é€æ˜**ï¼Œprompt å’Œå“åº”éƒ½èƒ½çœ‹åˆ°

## ğŸ” è°ƒè¯•å’Œæ—¥å¿—

### æµè§ˆå™¨æ§åˆ¶å° (F12)

```
[å‰ç«¯] å‘é€æµå¼è¯·æ±‚åˆ°API...
[å‰ç«¯] æ”¶åˆ°å“åº”, çŠ¶æ€: 200
[å‰ç«¯] æ”¶åˆ° Prompt
[å‰ç«¯] æ‰§è¡Œå®Œæˆ
```

### ç»ˆç«¯æ—¥å¿—

```
=== API /workflow/execute å¼€å§‹ ===
[Claude Service] æµå¼å“åº”å¼€å§‹
[Claude Service] æµå¼å“åº”å®Œæˆ, æ€»å—æ•°: 237
=== API /workflow/execute å®Œæˆ ===
```

## ğŸ¨ ä¸‹ä¸€æ­¥åŠŸèƒ½

### è®¡åˆ’ä¸­ï¼š

1. **Prompt æ¨¡æ¿é€‰æ‹©å™¨**
   - UI ç•Œé¢é€‰æ‹©æœ¬åœ° prompt æ¨¡æ¿
   - è‡ªåŠ¨å¡«å……å‚æ•°è¡¨å•
   - å®æ—¶é¢„è§ˆæ¸²æŸ“åçš„ prompt

2. **å‚æ•°æ™ºèƒ½æå–**
   - è‡ªåŠ¨è¯†åˆ« prompt ä¸­çš„æ‰€æœ‰å˜é‡
   - ç”Ÿæˆå¯¹åº”çš„è¾“å…¥è¡¨å•
   - æ”¯æŒå¤šç§å‚æ•°ç±»å‹ï¼ˆæ–‡ä»¶ã€ä»£ç ã€æ–‡æœ¬ç­‰ï¼‰

3. **è‡ªå®šä¹‰ Prompt**
   - ç”¨æˆ·å¯ä»¥æ·»åŠ è‡ªå·±çš„ prompt æ¨¡æ¿
   - åœ¨çº¿ç¼–è¾‘å’Œæµ‹è¯•
   - å¯¼å…¥/å¯¼å‡º prompt åº“

4. **å†å²è®°å½•**
   - ä¿å­˜æ‰€æœ‰æ‰§è¡Œçš„ prompt å’Œå“åº”
   - å¯ä»¥æŸ¥çœ‹ã€å¤åˆ¶ã€é‡æ–°æ‰§è¡Œ
   - å¯¼å‡ºä¸º Markdown æˆ– JSON

## ğŸš€ ç°åœ¨å°±è¯•è¯•ï¼

1. **åˆ·æ–°æµè§ˆå™¨** - http://localhost:3000
2. **é€‰æ‹©å·¥ä½œæµ** - ç‚¹å‡»å·¦ä¾§ä»»æ„å·¥ä½œæµ
3. **å¡«å†™éœ€æ±‚** - è¾“å…¥ç®€å•çš„ä»»åŠ¡æè¿°
4. **ç‚¹å‡»æ‰§è¡Œ** - çœ‹åˆ°å®æ—¶æµå¼æ˜¾ç¤ºï¼

---

**æ‰€æœ‰ä»£ç å·²å®Œæˆï¼ŒåŠŸèƒ½å¯ç”¨ï¼** âœ¨
