# 🚀 Claude Dev Assistant - 完整操作指南

> 一个让 AI 帮你写代码的智能开发助手，简单易用，功能强大

---

## 📖 目录

- [5分钟快速上手](#5分钟快速上手)
- [详细配置指南](#详细配置指南)
- [核心功能介绍](#核心功能介绍)
- [使用教程](#使用教程)
- [高级功能](#高级功能)
- [常见问题](#常见问题)

---

## ⚡ 5分钟快速上手

### 第一步：安装和配置

```bash
# 1. 安装依赖
npm install

# 2. 创建配置文件
cp .env.local.example .env.local

# 3. 编辑配置文件，填入你的 Claude API Key
# NEXT_PUBLIC_ANTHROPIC_AUTH_TOKEN=sk-ant-你的密钥

# 4. 启动服务（无需额外的文件服务器）
npm run dev
```

### 第二步：设置项目

1. 打开浏览器访问 http://localhost:3000
2. 点击右上角 **⚙️ 设置** 按钮
3. 点击 **📁 选择** 按钮，选择你的项目目录
4. 点击 **💾 保存**

### 第三步：开始使用

1. 在左侧选择一个工作流（如 **🎯 需求实现**）
2. 在输入框描述你的需求
3. 点击 **🚀 开始此步骤**
4. 观看 Claude 实时分析和编写代码

**就这么简单！** 🎉

---

## 🔧 详细配置指南

### 获取 Claude API 密钥

#### 方式一：使用官方 API（推荐）

1. 访问 [Anthropic Console](https://console.anthropic.com/)
2. 注册/登录账号
3. 点击左侧菜单 **API Keys**
4. 点击 **Create Key** 创建新密钥
5. 复制密钥（格式：`sk-ant-api03-xxxxx`）

#### 方式二：使用代理服务（国内用户）

如果你在国内无法访问 Anthropic，可以使用代理服务：

```env
# .env.local
NEXT_PUBLIC_ANTHROPIC_AUTH_TOKEN=你的密钥
NEXT_PUBLIC_ANTHROPIC_BASE_URL=https://你的代理地址.com/v1
```

### 完整配置文件示例

```env
# ===========================================
# Claude API 配置（必填）
# ===========================================
NEXT_PUBLIC_ANTHROPIC_AUTH_TOKEN=sk-ant-api03-xxxxx

# ===========================================
# API 代理配置（可选）
# ===========================================
# 如果使用代理服务，取消下面的注释并填入代理地址
# NEXT_PUBLIC_ANTHROPIC_BASE_URL=https://api.example.com/v1

# ===========================================
# 高级配置（可选）
# ===========================================
# Claude 最大输出 token 数（默认：32000）
NEXT_PUBLIC_CLAUDE_CODE_MAX_OUTPUT_TOKENS=32000

# 数据库连接（默认使用 SQLite）
# DATABASE_URL=postgresql://user:pass@localhost:5432/mydb
```

### 验证配置

启动后，点击右上角 **⚙️ 设置**，查看环境变量状态：

```
✓ ANTHROPIC_AUTH_TOKEN  ← 绿色对勾表示配置成功
ℹ BASE_URL: (默认)      ← 显示当前使用的 API 地址
```

---

## 🎨 核心功能介绍

### 1. 📋 预置工作流

系统内置了5种常用工作流，覆盖日常开发场景：

#### 🎯 需求实现
```
步骤1: 需求分析 - 理解需求，分析技术方案
步骤2: 设计方案 - 设计架构和接口
步骤3: 编码实现 - 编写实际代码
步骤4: 测试验证 - 单元测试 + E2E测试
步骤5: Git提交 - 自动生成 commit message
```

#### 🐛 Bug修复
```
步骤1: 问题诊断 - 分析错误日志和代码
步骤2: 定位问题 - 找到问题根源
步骤3: 修复实现 - 编写修复代码
步骤4: 回归测试 - 确保没有引入新问题
```

#### 🔄 代码重构
```
步骤1: 识别问题 - 找出需要重构的代码
步骤2: 重构方案 - 设计重构策略
步骤3: 实施重构 - 执行代码重构
步骤4: 验证结果 - 运行测试确保功能不变
```

#### 🧪 测试生成
```
步骤1: 分析代码 - 理解代码逻辑
步骤2: 生成测试 - 编写测试用例
步骤3: 覆盖检查 - 检查测试覆盖率
步骤4: 补充完善 - 补充边界情况测试
```

#### 📖 文档生成
```
步骤1: 代码分析 - 分析代码结构
步骤2: 生成文档 - 编写 API 文档
步骤3: 格式化 - 优化文档格式
```

### 2. 🤖 Claude 的超能力

Claude 可以做什么？

- ✅ **阅读你的代码** - 理解项目结构和业务逻辑
- ✅ **编写新代码** - 根据需求创建新文件
- ✅ **修改现有代码** - 直接编辑项目文件（通过服务端文件操作）
- ✅ **运行命令** - 执行测试、构建、Git 操作
- ✅ **分析问题** - 诊断 Bug 和性能问题
- ✅ **生成测试** - 自动编写单元测试和 E2E 测试

**注意**：所有文件操作都通过服务端 API 直接执行，**无需安装任何浏览器扩展**。

### 3. 🧠 智能上下文系统

系统会自动扫描你的项目，让 Claude 更了解你的代码：

```
📊 项目扫描结果示例：

✓ 项目路径: /Users/you/my-project
✓ 技术栈: React, TypeScript, Next.js
✓ 包管理器: npm
✓ 测试框架: Vitest
✓ E2E框架: Playwright

主要文件:
- app/page.tsx
- components/Header.tsx
- lib/utils.ts
- ...
```

这样 Claude 就不需要反复探索项目结构，执行速度更快！⚡

---

## 📚 使用教程

### 场景一：开发新功能

**需求**：在用户管理页面添加批量删除功能

#### 步骤 1：选择工作流

点击左侧 **🎯 需求实现** 工作流

#### 步骤 2：描述需求

在"对话输入"框中输入：

```
在用户管理页面添加批量删除功能，要求：

1. 功能需求：
   - 用户可以勾选多个用户
   - 点击"批量删除"按钮
   - 弹出确认对话框，显示将要删除的用户数量
   - 确认后调用批量删除API
   - 删除成功后刷新列表

2. 技术要求：
   - 使用现有的 Modal 组件
   - API 调用使用 userService
   - 添加错误处理和 loading 状态
   - 需要管理员权限才能删除

3. 文件位置：
   - 页面: app/admin/users/page.tsx
   - 服务: lib/services/userService.ts
```

#### 步骤 3：执行

点击 **🚀 开始此步骤**，Claude 会：

1. 分析现有代码结构
2. 读取相关文件（page.tsx, userService.ts）
3. 设计实现方案
4. 给出详细的技术方案

#### 步骤 4：查看结果

在右侧查看 Claude 的分析：

- 📋 技术方案
- 🎨 UI 设计建议
- 🔧 API 接口设计
- ⚠️ 注意事项

满意后，点击 **✅ 完成此步骤**

#### 步骤 5：继续后续步骤

系统自动进入"设计方案"步骤，重复上述流程。

#### 步骤 6：查看生成的代码

Claude 会直接修改你的项目文件，使用 Git 查看变更：

```bash
git diff
```

### 场景二：修复 Bug

**问题**：用户列表翻页后数据不刷新

#### 步骤 1：选择工作流

点击左侧 **🐛 Bug修复** 工作流

#### 步骤 2：描述问题

```
Bug描述：
用户列表页面点击翻页按钮后，数据没有刷新，
仍然显示第一页的数据。

复现步骤：
1. 打开用户列表页面
2. 点击"下一页"按钮
3. 观察列表内容

预期行为：
列表应该显示下一页的数据

实际行为：
列表内容没有变化

相关文件：
- app/admin/users/page.tsx
- components/UserList.tsx
```

#### 步骤 3：执行诊断

点击 **🚀 开始此步骤**，Claude 会：

1. 读取相关文件
2. 分析数据流
3. 定位问题原因
4. 给出修复建议

#### 步骤 4：继续修复

Claude 会进入下一步"修复实现"，直接修改代码文件。

#### 步骤 5：验证修复

Claude 会建议运行测试验证修复：

```bash
npm run test
npm run dev  # 手动测试
```

### 场景三：重构代码

**目标**：优化 UserService，提取重复代码

```
重构目标：
优化 lib/services/UserService.ts，主要问题：

1. getUserList 和 searchUsers 有大量重复代码
2. 错误处理逻辑分散在各个方法中
3. API 调用没有统一的重试机制

重构要求：
- 提取公共方法
- 统一错误处理
- 添加重试逻辑
- 保持原有功能不变
- 添加类型定义
```

Claude 会自动完成重构，并运行测试确保功能正常。

---

## 🎯 高级功能

### 1. 自定义工作流

如果预置工作流不满足需求，可以创建自定义工作流：

#### 创建步骤：

1. 点击工作流列表上方的 **➕** 按钮
2. 填写基本信息：
   ```
   名称: 性能优化流程
   描述: 分析性能瓶颈并优化
   图标: ⚡
   ```
3. 添加步骤：
   ```
   步骤1: 性能分析
   步骤2: 找出瓶颈
   步骤3: 优化实现
   步骤4: 压力测试
   ```
4. 保存工作流

### 2. 使用 Prompt 模板

#### 什么是 Prompt 模板？

Prompt 模板是预先编写好的指令，可以快速复用。

#### 使用方法：

1. 在步骤输入页面，点击右侧 **📚 选择 Prompt** 按钮
2. 浏览模板分类（Development、Testing、Documentation等）
3. 选择合适的模板
4. 填写模板参数
5. 模板会自动填充到输入框，可继续编辑

#### 创建自己的模板：

1. 点击 **➕ 创建模板** 按钮
2. 填写模板信息：
   ```
   名称: API接口设计
   分类: Custom
   内容: 
   请设计 {{feature_name}} 的 API 接口，要求：
   - RESTful 风格
   - 包含完整的请求/响应示例
   - 添加错误码说明
   ```
3. 保存到 `prompts/Custom/` 目录

### 3. 管理工作流步骤

#### 编辑步骤名称：
- **双击步骤**，输入新名称，按回车保存

#### 删除步骤：
- **悬停在步骤上**，点击右上角的 **×** 按钮

#### 插入步骤：
- **悬停在步骤之间的连线上**，点击 **+** 按钮

#### 添加步骤到末尾：
- 点击最后一个步骤后的 **+ 添加步骤** 按钮

### 4. 查看完整上下文

想知道 Claude 看到了什么？

1. 在步骤执行页面，点击 **🧠 查看上下文** 按钮
2. 在弹窗中查看：
   - 📤 发送给 Claude 的完整 Prompt
   - 📥 Claude 的完整回复
   - 🔧 项目上下文信息
   - 📜 对话历史

### 5. 继续对话

如果 Claude 的输出不满意，可以继续对话：

1. 在步骤输出下方的 **💬 继续对话** 输入框中补充说明
2. 点击 **💬 继续对话** 按钮
3. Claude 会基于之前的上下文继续回答

示例：
```
第1轮：请实现用户登录功能
第2轮：请添加"记住我"功能
第3轮：请改用 JWT 而不是 Session
```

---

## ❓ 常见问题

### Q1: 为什么执行很慢？

**可能原因**：
- Claude 在探索项目结构
- 项目文件过多（如包含 node_modules）
- 网络延迟

**解决方案**：
1. ✅ 系统已自动扫描项目上下文，Claude 会直接使用
2. ✅ 确保 `.gitignore` 中排除了 `node_modules`、`dist` 等大目录
3. ✅ 检查网络连接，考虑使用代理

**优化后的效果**：
- 之前：2-3分钟
- 现在：20-40秒

### Q2: Claude 只展示代码，不写入文件？

**原因**：任务描述不够明确

**解决方案**：

❌ **不好的描述**：
```
"写一个登录组件"
"优化这段代码"
```

✅ **好的描述**：
```
"创建 components/Login.tsx 文件，实现登录组件"
"修改 lib/utils.ts 中的 formatDate 函数，优化性能"
```

**提示**：明确说明"请创建文件"或"请修改文件"

### Q3: 如何查看 Claude 修改了哪些文件？

使用 Git 查看变更：

```bash
# 查看所有修改
git status

# 查看具体改动
git diff

# 查看某个文件的改动
git diff app/page.tsx
```

### Q4: 可以让 Claude 运行测试吗？

可以！Claude 可以执行任何 shell 命令：

在任务描述中说明：
```
实现功能后，请运行以下命令验证：
- npm run test
- npm run lint
- npm run build
```

Claude 会自动执行这些命令并展示结果。

### Q5: 如何切换不同的项目？

1. 点击右上角 **⚙️ 设置**
2. 点击 **📁 选择** 按钮，选择新项目
3. 点击 **💾 保存**

系统会自动重新扫描新项目的上下文。

### Q6: 支持哪些编程语言和框架？

**编程语言**：
- ✅ JavaScript / TypeScript
- ✅ Python
- ✅ Java
- ✅ Go
- ✅ Rust
- ✅ PHP
- ✅ Ruby
- ✅ C / C++
- ✅ 其他所有主流语言

**前端框架**：
- ✅ React / Next.js
- ✅ Vue / Nuxt
- ✅ Angular
- ✅ Svelte

**后端框架**：
- ✅ Express / Koa / Nest.js
- ✅ FastAPI / Django / Flask
- ✅ Spring Boot
- ✅ Gin / Echo

**测试框架**：
- ✅ Jest / Vitest
- ✅ Playwright / Cypress
- ✅ Pytest
- ✅ JUnit

### Q7: 数据安全吗？

- ✅ 所有操作在本地执行
- ✅ 只有必要的代码片段会发送给 Claude
- ✅ 不会上传整个项目
- ✅ API 密钥存储在本地 `.env.local`
- ✅ 文件操作通过 Next.js 服务端 API 执行，无需浏览器扩展

**安全建议**：
- ⚠️ 不要把 `.env.local` 提交到 Git
- ⚠️ 重要修改前先提交 Git
- ⚠️ 在测试项目中先试用

### Q8: 如何备份自定义工作流和模板？

**工作流**：
- 保存位置：`workflows/custom/`
- 使用 Git 提交即可备份

**Prompt 模板**：
- 保存位置：`prompts/Custom/`
- 使用 Git 提交即可备份

### Q9: 遇到错误怎么办？

**常见错误**：

1. **"未配置 ANTHROPIC_AUTH_TOKEN"**
   - 检查 `.env.local` 文件是否存在
   - 检查密钥格式是否正确（sk-ant-api03-xxx）

2. **"Connection error"**
   - 检查网络连接
   - 如果使用代理，检查 `NEXT_PUBLIC_ANTHROPIC_BASE_URL` 配置

3. **"Tool execution failed"**
   - 检查项目路径是否正确
   - 检查文件权限

**获取帮助**：
- 查看浏览器控制台（F12）的错误信息
- 查看终端的后端日志
- 在 GitHub 提 Issue

---

## 🎯 使用技巧

### 技巧 1：清晰的任务描述

**包含这些信息**：
1. ✅ **具体需求** - 要做什么
2. ✅ **技术要求** - 用什么技术
3. ✅ **相关文件** - 涉及哪些文件
4. ✅ **验收标准** - 怎样算完成

**示例**：
```
任务：添加用户导出功能

具体需求：
- 点击"导出"按钮，下载当前页面的用户数据
- 支持导出为 CSV 和 Excel 格式
- 文件名：users_YYYYMMDD.csv

技术要求：
- 使用 xlsx 库生成 Excel
- 添加 loading 状态和进度提示

相关文件：
- app/admin/users/page.tsx
- lib/utils/export.ts (如果不存在请创建)

验收标准：
- 可以成功下载文件
- 文件内容正确
- 有友好的错误提示
```

### 技巧 2：利用"相关文件"功能

如果任务涉及特定文件，在第一步时填写"相关文件"：

```
app/admin/users/page.tsx
components/UserTable.tsx
lib/services/userService.ts
```

这样 Claude 会优先读取这些文件，提高准确性。

### 技巧 3：分步执行复杂任务

不要一次性描述整个大功能，而是分步执行：

```
第1步：需求分析 ← 先让 Claude 理解需求
第2步：设计方案 ← 确认技术方案
第3步：编码实现 ← 实际编写代码
第4步：测试验证 ← 确保功能正常
```

每一步都可以用"继续对话"调整，确保方向正确。

### 技巧 4：利用"查看上下文"调试

如果 Claude 的输出不符合预期：

1. 点击 **🧠 查看上下文**
2. 检查 Claude 是否理解了你的需求
3. 检查项目上下文是否正确
4. 在"继续对话"中补充说明

### 技巧 5：保存有用的 Prompt

如果某个任务描述效果很好，可以：

1. 点击 **➕ 创建模板**
2. 把任务描述保存为模板
3. 下次直接选择模板使用

---

## 🚨 注意事项

### 安全提醒

- ⚠️ **Claude 可以执行任何命令** - 谨慎授权
- ⚠️ **重要代码先提交 Git** - 方便回滚
- ⚠️ **先在测试项目试用** - 熟悉后再用于生产
- ⚠️ **保护好 API 密钥** - 不要泄露和提交到 Git

### 性能优化建议

- 📁 **排除大目录** - 在 `.gitignore` 中排除 node_modules、dist 等
- ⚡ **明确任务描述** - 减少 Claude 的探索时间
- 🎯 **使用"相关文件"** - 帮助 Claude 快速定位

### 最佳实践

- ✅ **逐步执行** - 不要跳过步骤
- ✅ **及时反馈** - 用"继续对话"纠正方向
- ✅ **查看代码** - 检查 Claude 生成的代码
- ✅ **运行测试** - 确保功能正常

---

## 📞 获取支持

**遇到问题？**

1. 📖 查看本指南的[常见问题](#常见问题)部分
2. 💬 在 GitHub 提 Issue
3. 📧 发邮件给维护者

**功能建议？**

欢迎在 GitHub Discussions 提出建议！

---

## 🙏 结语

感谢使用 Claude Dev Assistant！

这个工具旨在提升你的开发效率，让 AI 成为你的得力助手。

如果觉得有用，请给我们一个 ⭐ Star！

**祝你开发愉快！** 🚀

---

**最后更新**: 2025-01
**版本**: 1.0.0
